SELECT
  COALESCE(
    ARRAY_AGG(uploadId),
    []
  ) as successfulUploads,
  COALESCE(
    ARRAY_AGG(
      STRING(ingestTime)
    ),
    []
  ) as successfulIngestTimes,
  COALESCE(
    ARRAY_AGG(
      STRUCT(
        tag as name, "mock-commit" as commit
      )
    ),
    []
  ) as successfulTags,
  COALESCE(
    STRING(
      MAX(ingestTime)
    ),
    NULL
  ) as latestSuccessfulUpload
FROM
  `mock-table`
WHERE
  commit = "mock-commit"
  AND repository = "mock-repository"
  AND owner = "mock-owner"
  AND provider = "github"