{%- set base_commit = event().base_commit is not same as null ? event().base_commit : event().parents[0] -%}
{%- set line_plural = report().uncovered_lines_change|abs != 1 ? 'lines' : 'line' -%}
## Coverage Report
> Merging #{{ event().pull_request }} will {{ (report().uncovered_lines_change > 0) ? '**increase** untested code by `' ~ report().uncovered_lines_change ~ ' ' ~ line_plural ~ '`' : (report().uncovered_lines_change < 0) ? '**decrease** untested code by `' ~ report().uncovered_lines_change|abs ~ ' ' ~ line_plural ~ '`' : '**not change** untested code' }} (compared to {{ base_commit }})

{% if report().diff_uncovered_lines > 0 %}
> [!WARNING]
> ** Consider additional tests:** There's `{{ report().diff_uncovered_lines }} {{ report().diff_uncovered_lines != 1 ? 'lines` that are new and not tested' : 'line` that is new and not tested' }}!
{% endif %}

| Total Coverage | Diff Coverage |
| --- | --- |
| {{ report().total_coverage|round(2) }}% | {{ report().diff_coverage is not same as null ? report().diff_coverage|round(2) ~ "%" : "&oslash;" }} |

<details>
<summary>Tags</summary>

{%~ if report().tag_coverage is not empty -%}
| Tag | Lines | Covered | Partial | Uncovered | Coverage |
| --- | --- | --- | --- | --- | --- |
{%~ for tag in report().tag_coverage -%}
| {{ tag.name|u.truncate(60, '...') }}{{ (tag.commit != event().head_commit) ? ('<br><sub>(Carried forward from ' ~ tag.commit ~ ')</sub>')|raw : '' }} | {{ tag.lines }} | {{ tag.covered }} | {{ tag.partial }} | {{ tag.uncovered }} | {{ tag.coverage_percentage|round(2) }}% |
{%~ endfor -%}
{%- else -%}
> No uploaded tags in #{{ event().pull_request }}
{%- endif -%}
</details>

<details>
<summary>Impacted Files</summary>

{% if report().impacted_files is not empty %}
| File | Diff Coverage |
| --- | --- |
{% for file in report().impacted_files %}
| {{ file.file_name }} | {{ file.coverage_percentage|round(2) }}% |
{% endfor %}
{% else %}
> No impacted files in #{{ event().pull_request }}
{% endif %}
</details>

*Last update to {{ event().head_commit }} at {{ event().event_time|date('H:ia e') }}*